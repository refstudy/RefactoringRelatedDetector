Data used in the study: https://drive.google.com/file/d/13ZXKbN9z2a_xINJ-CilnuKZ34ZqPDsGu/view?usp=sharing

## **The tool is made up of 2 projects.**

 **ChangeMetricsMiner** is responsible for assembling AST, comparing and generating code modifications between two versions of a file or commit.

**CustomRefactoringMiner** is responsible for detecting instances that refactoring has occurred using RefMiner. It will run ChangeMetricsMiner for each detected instance and filter/report code modifications based on the detected refactoring.

Configuration (Java openjdk 17.0.8.1 2023-08-24 LTS was used):

1- Clone the repository

	git clone https://github.com/refstudy/ase2024refactoring.git

2- Install the dependencies in both projects by running install in each root folder

    mvn install

2.1- Opening both projects in the same IDE studio will cause changes to ChangeMetricsMiner to be detected by CustomRefactoringMiner without a new install being necessary.

3- Adjust the settings in the config.json file of the CustomRefactoringMiner project. It is necessary to define a temporary folder to keep the cloned projects and an output folder for the output. Finally, for each project, simply enter the .git url and the branch to be collected.

    {
    
	    "tempFoldPath": ".\\projetos",
	    "outputFoldPath": ".\\data",
	    "repositories": [
			    {
			    "url": "https://github.com/jwtk/jjwt.git",
			    "mainBranch": "master",
			    },
		]
    }

4- Run the App.java in order to experiment the tool



Output example:

    [
        {
            "commit": "0ae8d9f3b740dff1a82fb8e4d1d0afc8cff1c7a8",
            "sourceElements": "[org.activiti.engine.FormService.addComment(String, String, String)]",
            "targetElements": "[org.activiti.engine.TaskService.addComment(String, String, String)]",
            "type": "MOVE_METHOD",
            "related": [
                {
                    "Metric": "ADDED_METHOD",
                    "Method": "org.activiti.engine.TaskService",
                    "Local": "L[268,269], C[3,75]",
                    "Detail": "org.activiti.engine.TaskService.addComment(String, String, String)",
                    "Code": "/** \n * Add a comment to a task and/or process instance. \n */\nvoid addComment(String taskId,String processInstanceId,String message);\n",
                    "relationType": "MENTIONED_DECLARATION",
                    "distance": 0
                },
                {
                    "Metric": "REMOVED_METHOD",
                    "Method": "org.activiti.engine.FormService",
                    "Local": "L[76,77], C[3,75]",
                    "Detail": "org.activiti.engine.FormService.addComment(String, String, String)",
                    "Code": "/** \n * Add a comment to a task and/or process instance. \n */\nvoid addComment(String taskId,String processInstanceId,String message);\n",
                    "relationType": "MENTIONED_DECLARATION",
                    "distance": 0
                },
                {
                    "Metric": "REMOVED_Javadoc",
                    "Method": "org.activiti.engine.FormService.addComment(String, String, String)",
                    "Local": "L[76,76], C[3,57]",
                    "Detail": null,
                    "Code": "/** \n * Add a comment to a task and/or process instance. \n */\n",
                    "relationType": "MENTIONED",
                    "distance": 0
                },
                {
                    "Metric": "REMOVED_TextElement",
                    "Method": "org.activiti.engine.FormService.addComment(String, String, String)",
                    "Local": "L[76,76], C[7,55]",
                    "Detail": null,
                    "Code": "Add a comment to a task and/or process instance. ",
                    "relationType": "MENTIONED",
                    "distance": 0
                },
                {
                    "Metric": "REMOVED_TagElement",
                    "Method": "org.activiti.engine.FormService.addComment(String, String, String)",
                    "Local": "L[76,76], C[7,55]",
                    "Detail": null,
                    "Code": "\n * Add a comment to a task and/or process instance. ",
                    "relationType": "MENTIONED",
                    "distance": 0
                },
                {
                    "Metric": "ADDED_Javadoc",
                    "Method": "org.activiti.engine.TaskService.addComment(String, String, String)",
                    "Local": "L[268,268], C[3,57]",
                    "Detail": null,
                    "Code": "/** \n * Add a comment to a task and/or process instance. \n */\n",
                    "relationType": "MENTIONED",
                    "distance": 0
                },
                {
                    "Metric": "ADDED_TextElement",
                    "Method": "org.activiti.engine.TaskService.addComment(String, String, String)",
                    "Local": "L[268,268], C[7,55]",
                    "Detail": null,
                    "Code": "Add a comment to a task and/or process instance. ",
                    "relationType": "MENTIONED",
                    "distance": 0
                },
                {
                    "Metric": "ADDED_TagElement",
                    "Method": "org.activiti.engine.TaskService.addComment(String, String, String)",
                    "Local": "L[268,268], C[7,55]",
                    "Detail": null,
                    "Code": "\n * Add a comment to a task and/or process instance. ",
                    "relationType": "MENTIONED",
                    "distance": 0
                }
            ],
            "notRelated": [
                {
                    "Metric": "REMOVED_Javadoc",
                    "Method": "org.activiti.engine.FormService.getTaskComments(String)",
                    "Local": "L[79,79], C[3,48]",
                    "Detail": null,
                    "Code": "/** \n * The comments related to the given task. \n */\n",
                    "relationType": "NOT_RELATED",
                    "distance": 99
                },
                {
                    "Metric": "REMOVED_ParameterizedType",
                    "Method": "org.activiti.engine.FormService.getTaskComments(String)",
                    "Local": "L[80,80], C[3,15]",
                    "Detail": null,
                    "Code": "List<Comment>",
                    "relationType": "NOT_RELATED",
                    "distance": 99
                },
    
                {
                    "Metric": "REMOVED_ParameterizedType",
                    "Method": "org.activiti.engine.FormService.getProcessInstanceComments(String)",
                    "Local": "L[83,83], C[3,15]",
                    "Detail": null,
                    "Code": "List<Comment>",
                    "relationType": "NOT_RELATED",
                    "distance": 99
                },
     
            ],
            "metadata": {
                "type": "Move Method",
                "description": "Move Method public addComment(taskId String, processInstanceId String, message String) : void from class org.activiti.engine.FormService to public addComment(taskId String, processInstanceId String, message String) : void from class org.activiti.engine.TaskService",
                "leftSideLocations": [
                    {
                        "filePath": "modules/activiti-engine/src/main/java/org/activiti/engine/FormService.java",
                        "startLine": 76,
                        "endLine": 77,
                        "startColumn": 3,
                        "endColumn": 76,
                        "codeElementType": "METHOD_DECLARATION",
                        "description": "original method declaration",
                        "codeElement": "public addComment(taskId String, processInstanceId String, message String) : void"
                    }
                ],
                "rightSideLocations": [
                    {
                        "filePath": "modules/activiti-engine/src/main/java/org/activiti/engine/TaskService.java",
                        "startLine": 268,
                        "endLine": 269,
                        "startColumn": 3,
                        "endColumn": 76,
                        "codeElementType": "METHOD_DECLARATION",
                        "description": "moved method declaration",
                        "codeElement": "public addComment(taskId String, processInstanceId String, message String) : void"
                    }
                ]
            }
        }
    
    ]


## **Change Metrics**


List of change metrics detected in the study

	   "ACCESS_INCREASED",
	   "ACCESS_REDUCED",
	   "ADDED_ANNOTATION",
	   "ADDED_ASSERTSTATEMENT",
	   "ADDED_BREAKSTATEMENT",
	   "ADDED_CATCH_CLAUSE",
	   "ADDED_CLASS",
	   "ADDED_CLASS_ANONYMOUS_DECLARATION",
	   "ADDED_CLASS_INSTANCE",
	   "ADDED_CONSTRUCTORINVOCATION",
	   "ADDED_CONTINUESTATEMENT",
	   "ADDED_DOSTATEMENT",
	   "ADDED_ELSE_STATEMENT",
	   "ADDED_ENHANCEDFORSTATEMENT",
	   "ADDED_ENUM",
	   "ADDED_EXCEPTION_THROWN",
	   "ADDED_EXPRESSIONSTATEMENT",
	   "ADDED_FORSTATEMENT",
	   "ADDED_HIERARCHY",
	   "ADDED_IF_STATEMENT",
	   "ADDED_IMPORT",
	   "ADDED_INTERFACE",
	   "ADDED_LABELEDSTATEMENT",
	   "ADDED_METHOD",
	   "ADDED_METHOD_CALL",
	   "ADDED_PARAMETER",
	   "ADDED_RECORD",
	   "ADDED_RETURN_VALUE",
	   "ADDED_SUPERCONSTRUCTORINVOCATION",
	   "ADDED_SWITCHCASE",
	   "ADDED_SWITCHSTATEMENT",
	   "ADDED_SYNCHRONIZEDSTATEMENT",
	   "ADDED_THROWSTATEMENT",
	   "ADDED_TRYSTATEMENT",
	   "ADDED_TRY_CATCH",
	   "ADDED_VARIABLE",
	   "ADDED_WHILESTATEMENT",
	   "ADDED_YIELDSTATEMENT",
	   "CATCH_CLAUSE_CHANGE",
	   "CATCH_HANDLING_CHANGE",
	   "CHANGED_ANONYMOUS_DECLARATION",
	   "CHANGED_ASSERTSTATEMENT",
	   "CHANGED_BREAKSTATEMENT",
	   "CHANGED_CLASS",
	   "CHANGED_CONSTRUCTORINVOCATION",
	   "CHANGED_CONTINUESTATEMENT",
	   "CHANGED_DOSTATEMENT",
	   "CHANGED_ELSE_CONDITION",
	   "CHANGED_ENHANCEDFORSTATEMENT",
	   "CHANGED_ENUM",
	   "CHANGED_EXISTING_ELSE_BLOCK",
	   "CHANGED_EXISTING_IF_BLOCK",
	   "CHANGED_EXPRESSIONSTATEMENT",
	   "CHANGED_FORSTATEMENT",
	   "CHANGED_HIERARCHY",
	   "CHANGED_IF_CONDITION",
	   "CHANGED_IMPORT",
	   "CHANGED_INTERFACE",
	   "CHANGED_LABELEDSTATEMENT",
	   "CHANGED_RECORD",
	   "CHANGED_RETURN_TYPE",
	   "CHANGED_RETURN_VALUE",
	   "CHANGED_SUPERCONSTRUCTORINVOCATION",
	   "CHANGED_SWITCHCASE",
	   "CHANGED_SWITCHSTATEMENT",
	   "CHANGED_SYNCHRONIZEDSTATEMENT",
	   "CHANGED_THROWSTATEMENT",
	   "CHANGED_TRYSTATEMENT",
	   "CHANGED_VARIABLE",
	   "CHANGED_VAR_VALUE",
	   "CHANGED_WHILESTATEMENT",
	   "CHANGED_YIELDSTATEMENT",
	   "CLASS_INSTANCE_ARGUMENTS_CHANGE",
	   "METHOD_CALL_ARGUMENTS_CHANGE",
	   "REMOVED_ANNOTATION",
	   "REMOVED_ASSERTSTATEMENT",
	   "REMOVED_BREAKSTATEMENT",
	   "REMOVED_CATCH_CLAUSE",
	   "REMOVED_CLASS",
	   "REMOVED_CLASS_ANONYMOUS_DECLARATION",
	   "REMOVED_CLASS_INSTANCE",
	   "REMOVED_CONSTRUCTORINVOCATION",
	   "REMOVED_CONTINUESTATEMENT",
	   "REMOVED_DOSTATEMENT",
	   "REMOVED_ELSE_STATEMENT",
	   "REMOVED_ENHANCEDFORSTATEMENT",
	   "REMOVED_ENUM",
	   "REMOVED_EXCEPTION_THROWN",
	   "REMOVED_EXPRESSIONSTATEMENT",
	   "REMOVED_FORSTATEMENT",
	   "REMOVED_HIERARCHY",
	   "REMOVED_IF_STATEMENT",
	   "REMOVED_IMPORT",
	   "REMOVED_INTERFACE",
	   "REMOVED_LABELEDSTATEMENT",
	   "REMOVED_METHOD",
	   "REMOVED_METHOD_CALL",
	   "REMOVED_PARAMETER",
	   "REMOVED_RECORD",
	   "REMOVED_RETURN_VALUE",
	   "REMOVED_SUPERCONSTRUCTORINVOCATION",
	   "REMOVED_SWITCHCASE",
	   "REMOVED_SWITCHSTATEMENT",
	   "REMOVED_SYNCHRONIZEDSTATEMENT",
	   "REMOVED_THROWSTATEMENT",
	   "REMOVED_TRYSTATEMENT",
	   "REMOVED_TRY_CATCH",
	   "REMOVED_VARIABLE",
	   "REMOVED_WHILESTATEMENT",
	   "REMOVED_YIELDSTATEMENT",
	   "RENAME_ELEMENT",
	   "TRY_CATCH_CHANGE",
	   "TURNED_INTO_CLASS",
	   "TURNED_INTO_INTERFACE",
	   "VAR_TYPE_CHANGED"

Based on AST

        "ADDED_AnnotationTypeDeclaration",
        "ADDED_AnnotationTypeMemberDeclaration",
        "ADDED_AnonymousClassDeclaration",
        "ADDED_ArrayAccess",
        "ADDED_ArrayCreation",
        "ADDED_ArrayInitializer",
        "ADDED_ArrayType",
        "ADDED_BooleanLiteral",
        "ADDED_CastExpression",
        "ADDED_CatchClause",
        "ADDED_CharacterLiteral",
        "ADDED_ClassInstanceCreation",
        "ADDED_ConditionalExpression",
        "ADDED_CreationReference",
        "ADDED_Dimension",
        "ADDED_EnumConstantDeclaration",
        "ADDED_EnumDeclaration",
        "ADDED_ExpressionMethodReference",
        "ADDED_FieldAccess",
        "ADDED_FieldDeclaration",
        "ADDED_ImportDeclaration",
        "ADDED_InfixExpression",
        "ADDED_Initializer",
        "ADDED_InstanceofExpression",
        "ADDED_IntersectionType",
        "ADDED_Javadoc",
        "ADDED_LambdaExpression",
        "ADDED_MarkerAnnotation",
        "ADDED_MemberRef",
        "ADDED_MemberValuePair",
        "ADDED_MethodRef",
        "ADDED_MethodRefParameter",
        "ADDED_Modifier",
        "ADDED_ModuleQualifiedName",
        "ADDED_NameQualifiedType",
        "ADDED_NormalAnnotation",
        "ADDED_NullLiteral",
        "ADDED_PackageDeclaration",
        "ADDED_ParameterizedType",
        "ADDED_ParenthesizedExpression",
        "ADDED_PatternInstanceofExpression",
        "ADDED_PostfixExpression",
        "ADDED_PrefixExpression",
        "ADDED_QualifiedType",
        "ADDED_RecordDeclaration",
        "ADDED_SingleMemberAnnotation",
        "ADDED_SuperFieldAccess",
        "ADDED_SuperMethodInvocation",
        "ADDED_SuperMethodReference",
        "ADDED_SwitchExpression",
        "ADDED_TagElement",
        "ADDED_TextBlock",
        "ADDED_TextElement",
        "ADDED_ThisExpression",
        "ADDED_TypeDeclarationStatement",
        "ADDED_TypeLiteral",
        "ADDED_TypeMethodReference",
        "ADDED_TypeParameter",
        "ADDED_UnionType",
        "ADDED_VariableDeclarationExpression",
        "ADDED_WildcardType",
        "CHANGED_AnnotationTypeDeclaration",
        "CHANGED_AnnotationTypeMemberDeclaration",
        "CHANGED_AnonymousClassDeclaration",
        "CHANGED_ArrayAccess",
        "CHANGED_ArrayCreation",
        "CHANGED_ArrayInitializer",
        "CHANGED_ArrayType",
        "CHANGED_BooleanLiteral",
        "CHANGED_CastExpression",
        "CHANGED_CatchClause",
        "CHANGED_CharacterLiteral",
        "CHANGED_ClassInstanceCreation",
        "CHANGED_ConditionalExpression",
        "CHANGED_CreationReference",
        "CHANGED_Dimension",
        "CHANGED_EnumConstantDeclaration",
        "CHANGED_EnumDeclaration",
        "CHANGED_ExpressionMethodReference",
        "CHANGED_FieldAccess",
        "CHANGED_FieldDeclaration",
        "CHANGED_ImportDeclaration",
        "CHANGED_InfixExpression",
        "CHANGED_Initializer",
        "CHANGED_InstanceofExpression",
        "CHANGED_Javadoc",
        "CHANGED_LambdaExpression",
        "CHANGED_MarkerAnnotation",
        "CHANGED_MemberRef",
        "CHANGED_MemberValuePair",
        "CHANGED_MethodRef",
        "CHANGED_MethodRefParameter",
        "CHANGED_Modifier",
        "CHANGED_NormalAnnotation",
        "CHANGED_PackageDeclaration",
        "CHANGED_ParameterizedType",
        "CHANGED_ParenthesizedExpression",
        "CHANGED_PatternInstanceofExpression",
        "CHANGED_PostfixExpression",
        "CHANGED_PrefixExpression",
        "CHANGED_QualifiedType",
        "CHANGED_RecordDeclaration",
        "CHANGED_SingleMemberAnnotation",
        "CHANGED_SuperFieldAccess",
        "CHANGED_SuperMethodInvocation",
        "CHANGED_SwitchExpression",
        "CHANGED_TagElement",
        "CHANGED_TextBlock",
        "CHANGED_TextElement",
        "CHANGED_ThisExpression",
        "CHANGED_TypeLiteral",
        "CHANGED_TypeParameter",
        "CHANGED_UnionType",
        "CHANGED_VariableDeclarationExpression",
        "CHANGED_WildcardType",
        "REMOVED_AnnotationTypeDeclaration",
        "REMOVED_AnnotationTypeMemberDeclaration",
        "REMOVED_AnonymousClassDeclaration",
        "REMOVED_ArrayAccess",
        "REMOVED_ArrayCreation",
        "REMOVED_ArrayInitializer",
        "REMOVED_ArrayType",
        "REMOVED_BooleanLiteral",
        "REMOVED_CastExpression",
        "REMOVED_CatchClause",
        "REMOVED_CharacterLiteral",
        "REMOVED_ClassInstanceCreation",
        "REMOVED_ConditionalExpression",
        "REMOVED_CreationReference",
        "REMOVED_Dimension",
        "REMOVED_EnumConstantDeclaration",
        "REMOVED_EnumDeclaration",
        "REMOVED_ExpressionMethodReference",
        "REMOVED_FieldAccess",
        "REMOVED_FieldDeclaration",
        "REMOVED_ImportDeclaration",
        "REMOVED_InfixExpression",
        "REMOVED_Initializer",
        "REMOVED_InstanceofExpression",
        "REMOVED_IntersectionType",
        "REMOVED_Javadoc",
        "REMOVED_LambdaExpression",
        "REMOVED_MarkerAnnotation",
        "REMOVED_MemberRef",
        "REMOVED_MemberValuePair",
        "REMOVED_MethodRef",
        "REMOVED_MethodRefParameter",
        "REMOVED_Modifier",
        "REMOVED_NameQualifiedType",
        "REMOVED_NormalAnnotation",
        "REMOVED_NullLiteral",
        "REMOVED_PackageDeclaration",
        "REMOVED_ParameterizedType",
        "REMOVED_ParenthesizedExpression",
        "REMOVED_PatternInstanceofExpression",
        "REMOVED_PostfixExpression",
        "REMOVED_PrefixExpression",
        "REMOVED_QualifiedType",
        "REMOVED_RecordDeclaration",
        "REMOVED_SingleMemberAnnotation",
        "REMOVED_SuperFieldAccess",
        "REMOVED_SuperMethodInvocation",
        "REMOVED_SuperMethodReference",
        "REMOVED_SwitchExpression",
        "REMOVED_TagElement",
        "REMOVED_TextBlock",
        "REMOVED_TextElement",
        "REMOVED_ThisExpression",
        "REMOVED_TypeDeclarationStatement",
        "REMOVED_TypeLiteral",
        "REMOVED_TypeMethodReference",
        "REMOVED_TypeParameter",
        "REMOVED_UnionType",
        "REMOVED_VariableDeclarationExpression",
        "REMOVED_WildcardType
        
Includes all other AST nodes as well;


